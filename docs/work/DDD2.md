# åŸºäºÂ DDDÂ çš„å‰ç«¯å·¥ç¨‹Â V2

## åˆ†å±‚æ¶æ„

![image](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/Rq8z1PLnvha4wKAN/62fbf3d5468f4cada417e14ebfc7e98d1257.png)

æ•´ä½“ç†å¿µåŸºäºé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDomain-DrivenÂ Designï¼‰ï¼Œé¢†åŸŸå±‚ä½äºæœ€æ ¸å¿ƒçš„ä½ç½®ï¼Œå¹¶ä¸”æœ‰ç€ä¸€ä¸ªä¸¥æ ¼çš„ä¾èµ–è§„åˆ™ï¼šä¸Šå±‚å¯ä»¥ä¾èµ–ä¸‹å±‚ï¼Œä½†ä¸‹å±‚ä¸èƒ½ä¾èµ–ä¸Šå±‚ã€‚

ç›®æ ‡æ˜¯åœ¨å‰ç«¯å·¥ç¨‹è®¾è®¡ä¸­èƒ½åšåˆ°ï¼š

*   è§†å›¾å±‚å°½å¯èƒ½è–„ï¼šè·å¾—çš„æ•°æ®èƒ½å¤Ÿç›´æ¥ä½¿ç”¨åˆ°è§†å›¾å±‚ä¸­ï¼Œç¦æ­¢åœ¨è§†å›¾å±‚ä¸­å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ã€ç­›é€‰ã€è®¡ç®—ç­‰é€»è¾‘æ“ä½œã€‚
    
*   ä¸åŒèŒè´£çš„ä»£ç è¿›è¡Œåˆ†å±‚ï¼šå°†ä¸åŒèŒè´£ä»£ç åˆç†åˆ†å±‚ï¼Œæ¯å±‚å°½å¯èƒ½çº¯å‡€ï¼Œäº’ä¸å½±å“ã€‚
    
*   å‰ç«¯å­—æ®µä¸å—åç«¯å½±å“ï¼šè¿”å›å­—æ®µè¿›è¡Œçº æ­£ï¼Œå­—æ®µå«ä¹‰å°½å¯èƒ½ç›´è§‚ï¼Œåœ¨è§†å›¾å±‚ä½¿ç”¨æ—¶ï¼Œèƒ½å¤Ÿæ›´æ¸…æ™°åœ°æè¿°è§†å›¾ç»“æ„ã€‚
    
*   å¯çºµè§‚å…¨å±€é¢†åŸŸï¼šå‰ç«¯è¿›è¡Œé¢†åŸŸæ¨¡å—ç»“æ„è®¾è®¡æ—¶ï¼Œèƒ½å¤Ÿçºµè§ˆæ•´ä¸ªé¡¹ç›®ä¸‹æ‰€æœ‰çš„é¢†åŸŸï¼Œä»¥åŠæ¯ä¸ªé¢†åŸŸä¸‹å…·æœ‰çš„é€»è¾‘åŠŸèƒ½ã€‚
    

### é¢†åŸŸå±‚Â domain

é¢†åŸŸå±‚æ˜¯æ•´ä¸ªé¡¹ç›®çš„æ ¸å¿ƒå±‚ï¼Œå®ƒæŒç®¡äº†æ‰€æœ‰é¢†åŸŸä¸‹çš„è¡Œä¸ºä¸å®šä¹‰ã€‚è¿™éƒ¨åˆ†åº”è¯¥æ˜¯ä¸å…·ä½“æŠ€æœ¯å®ç°æ— å…³çš„çº¯ç²¹çš„ä¸šåŠ¡é€»è¾‘ã€‚

#### é¢†åŸŸæ¨¡å‹Â models

**èšåˆï¼š**æŒ‡çš„æ˜¯é™ç•Œä¸Šä¸‹æ–‡ä¸­ä¸€ä¸ªä¸ªçš„ä»£ç é›†åˆä½“ï¼Œç”±å®ä½“æˆ–å€¼å¯¹è±¡æ„æˆï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå¤„äºæ ¹èŠ‚ç‚¹çš„å®ä½“è¢«ç§°ä¸º**èšåˆæ ¹**ï¼ˆAggregateÂ Rootï¼‰ã€‚èšåˆæ ¹æ§åˆ¶ç€æ‰€æœ‰èšé›†åœ¨å…¶ä¸­çš„å…¶ä»–å…ƒç´ ï¼Œå¹¶ä¸”å®ƒçš„åç§°å°±æ˜¯æ•´ä¸ªèšåˆçš„åç§°ã€‚

**å®ä½“ï¼š**æ˜¯å……è¡€çš„æ•°æ®å¯¹è±¡ï¼ŒåŒ…å«äº†æ•°æ®å’Œä¸šåŠ¡è§„åˆ™ï¼Œä¸”æ•°æ®å’Œä¸šåŠ¡è§„åˆ™æ˜¯å†…èšçš„ã€‚æ¯ä¸ªå®ä½“éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼ˆIDï¼‰ï¼Œä¾‹å¦‚è®¢å•ã€ç”¨æˆ·ã€è´¦æˆ·ç­‰ã€‚å®ä½“åœ¨å…¨å±€é¢†åŸŸä¸­æ˜¯å”¯ä¸€çš„ï¼Œä¸å¯èƒ½åœ¨åˆ«çš„é¢†åŸŸä¸­å­˜åœ¨ç›¸åŒçš„å®ä½“ã€‚åœ¨å‰ç«¯ä¸­ï¼Œæˆ‘ä»¬æŠŠå®ƒå®šä¹‰ä¸ºä¸€ä¸ªÂ classÂ ç±»ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–å®ä½“çš„å±æ€§ï¼Œåœ¨ç±»ä¸­å®šä¹‰äº†å®ä½“çš„æ–¹æ³•ï¼Œå®ç°ä¸å…¶è‡ªèº«ç´§å¯†ç›¸å…³çš„ä¸šåŠ¡æ“ä½œã€‚ä¾‹å¦‚ï¼šåˆåŒå®ä½“å¯èƒ½æœ‰Â updateData()ã€getDisplayText()ã€getForceReadContracts()ç­‰æ–¹æ³•ã€‚åŒä¸€ä¸ªå®ä½“çš„é€»è¾‘ç¡®ä¿åªåœ¨å®ä½“ç±»ä¸­ç¼–å†™ï¼Œåœ¨ä¸åŒè§†å›¾ä¸‹å¯å¤ç”¨ã€‚

**å€¼å¯¹è±¡ï¼š**ä¹Ÿæ˜¯å……è¡€çš„æ•°æ®å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥åŒ…å«ä¸šåŠ¡è§„åˆ™ï¼Œä½†æ²¡æœ‰å”¯ä¸€æ ‡è¯†ï¼Œä¾‹å¦‚Moneyã€Addressã€Phoneç­‰ã€‚

#### é¢†åŸŸçŠ¶æ€å­˜å‚¨Â stores

é¢†åŸŸÂ storeÂ ç®¡ç†ç›¸å¯¹ç‹¬ç«‹çš„ä¸šåŠ¡é¢†åŸŸæˆ–ä¸Šä¸‹æ–‡çš„æ•°æ®ï¼Œè´Ÿè´£**é¢†åŸŸå¯¹è±¡ï¼ˆå®ä½“ï¼‰çš„åˆ›å»ºã€ç¼“å­˜ï¼Œå¹¶æä¾›å¯¹å¤–çš„æ“ä½œæ¥å£ï¼ˆå¢åˆ æ”¹æŸ¥ç­‰ï¼‰**ã€‚æ¯ä¸ªé¢†åŸŸÂ StoreÂ é€šå¸¸åœ¨åº”ç”¨ä¸­ä½œä¸ºå•ä¾‹å­˜åœ¨ï¼Œé¿å…åŒä¸€é¢†åŸŸå¯¹è±¡å‡ºç°å¤šä¸ªå†…å­˜å®ä¾‹ï¼Œä¿è¯ä¾‹å¦‚åŒä¸€ä¸ªå•†å“åœ¨Â ProductStoreÂ å’ŒÂ CartStoreÂ ä¸­å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§å’ŒçŠ¶æ€åŒæ­¥ã€‚

å…·ä½“ç»„ç»‡ä¸Šï¼Œå¯ä»¥è®¾ç«‹ä¸€ä¸ªRootÂ Storeï¼ˆæ ¹å­˜å‚¨ï¼‰ç”¨äºç»„åˆå’ŒæŒæœ‰æ‰€æœ‰é¢†åŸŸÂ StoresÂ å®ä¾‹ï¼Œæ–¹ä¾¿åœ¨åº”ç”¨ä¸­é€šè¿‡Â ContextÂ æˆ–ä¾èµ–æ³¨å…¥æä¾›ç»™ç»„ä»¶ä½¿ç”¨ã€‚[MobXÂ æ–‡æ¡£](https://cn.mobx.js.org/best/store.html)ä¸­å¼ºè°ƒï¼Œé¢†åŸŸÂ StoreÂ çš„èŒè´£åŒ…æ‹¬ï¼šå®ä¾‹åŒ–é¢†åŸŸå¯¹è±¡ã€ç»´æŠ¤å¯¹è±¡å”¯ä¸€æ€§ã€å¤„ç†æŒä¹…åŒ–ï¼ˆä¸åç«¯äº¤äº’ï¼‰ã€æ¥æ”¶åç«¯æ›´æ–°å¹¶æ›´æ–°ç°æœ‰å®ä¾‹ç­‰ã€‚é€šè¿‡åˆç†æ‹†åˆ†Â Storeï¼Œæˆ‘ä»¬æ—¢å®ç°äº†é¢†åŸŸè¾¹ç•Œçš„æ¨¡å—åŒ–,Â ä¹Ÿä¿æŒäº†é¢†åŸŸæ¨¡å‹çš„å¹²å‡€çº¯ç²¹ã€‚

#### é¢†åŸŸæœåŠ¡Â services

é¢†åŸŸæœåŠ¡å°è£…ä¸é€‚åˆæ”¾åœ¨å®ä½“æˆ–å€¼å¯¹è±¡ä¸­çš„é¢†åŸŸé€»è¾‘ï¼Œå½“æŸä¸ªä¸šåŠ¡æ“ä½œæˆ–é¢†åŸŸé€»è¾‘ï¼šÂ Â Â Â 

*   **æ¶‰åŠå¤šä¸ªä¸åŒçš„å®ä½“ï¼ˆæˆ–èšåˆï¼‰ï¼Œè¿›è¡Œä¸šåŠ¡ç¼–æ’å’Œåè°ƒ**ï¼Œä»¥å®Œæˆä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·æ•…äº‹ã€‚æ¯”å¦‚â€œç”¨æˆ·ä¸‹å•â€æœåŠ¡å¯èƒ½éœ€è¦æ£€éªŒè´­ç‰©è½¦å•†å“åº“å­˜ã€è®¡ç®—ä»·æ ¼ï¼ˆè°ƒç”¨å•†å“é¢†åŸŸé€»è¾‘ï¼‰ã€å†åˆ›å»ºè®¢å•å¯¹è±¡å¹¶è°ƒç”¨è®¢å•ä»“å‚¨ä¿å­˜ï¼Œæœ€åæ¸…ç©ºè´­ç‰©è½¦ã€‚è¿™ä¸€ç³»åˆ—æ“ä½œå¯ä»¥é€šè¿‡ä¸€ä¸ªÂ OrderService.checkout(cart)Â å®Œæˆï¼Œå†…éƒ¨åè°ƒå„é¢†åŸŸå¯¹è±¡é…åˆã€‚
    
*   ä¸è‡ªç„¶åœ°å±äºä»»ä½•ä¸€ä¸ªç‰¹å®šçš„å®ä½“ï¼ˆå³ï¼Œå°†è¿™ä¸ªé€»è¾‘æ”¾åœ¨ä»»ä½•ä¸€ä¸ªå®ä½“ä¸­éƒ½ä¼šæ˜¾å¾—ä¸åè°ƒæˆ–ç ´åè¯¥å®ä½“çš„å•ä¸€èŒè´£ï¼‰ã€‚
    
*   ä»£è¡¨ä¸€ä¸ªé‡è¦çš„é¢†åŸŸè¿‡ç¨‹æˆ–è®¡ç®—ï¼Œä½†æœ¬èº«ä¸æ˜¯ä¸€ä¸ªâ€œäº‹ç‰©â€ï¼ˆæ²¡æœ‰èº«ä»½ï¼‰ï¼Œæ¯”å¦‚å¤æ‚è¡¨å•çš„æ ¡éªŒã€‚
    

Â é¢†åŸŸæœåŠ¡æœ¬èº«é€šå¸¸æ˜¯æ— çŠ¶æ€çš„ã€‚å®ƒä»¬ä¸æŒæœ‰è‡ªå·±çš„æ•°æ®çŠ¶æ€ï¼Œè€Œæ˜¯æ“ä½œä¼ å…¥çš„é¢†åŸŸå¯¹è±¡ï¼ˆå®ä½“æˆ–å€¼å¯¹è±¡ï¼‰ã€‚æ¯æ¬¡è°ƒç”¨çš„ç»“æœä»…ä¾èµ–äºè¾“å…¥å‚æ•°ã€‚

é€šè¿‡é¢†åŸŸæœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…å°†å¤æ‚ä¸šåŠ¡é€»è¾‘æ•£è½åœ¨Â UIÂ ç»„ä»¶æˆ–å¤šä¸ªå¯¹è±¡ä¸­ï¼Œæé«˜æ¨¡å—å¤ç”¨æ€§å’Œæµ‹è¯•æ€§ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé¢†åŸŸæœåŠ¡ä¸æ˜¯å¿…éœ€çš„ï¼Œå¦‚æœä¸šåŠ¡é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¹Ÿå¯ä»¥ä¸å¼•å…¥é¢å¤–çš„æœåŠ¡å±‚ï¼Œç›´æ¥åœ¨é¢†åŸŸå¯¹è±¡æˆ–Â StoreÂ ä¸­å®ç°ã€‚ä½†éšç€åº”ç”¨æˆé•¿ï¼Œ**æœåŠ¡å±‚æœ‰åŠ©äºä¿æŒé¢†åŸŸå¯¹è±¡çš„å•ä¸€èŒè´£**ï¼ˆé¿å…è†¨èƒ€ä¸ºâ€œä¸Šå¸å¯¹è±¡â€ï¼‰ï¼ŒåŒæ—¶å®ç°**å¤åˆä¸šåŠ¡åœºæ™¯çš„é«˜å†…èšã€ä½è€¦åˆ**ã€‚

### æ•°æ®æ¥å£å±‚Â api

æ•°æ®æ¥å£å±‚æ˜¯æ•´ä¸ªé¡¹ç›®çš„æ ¹åŸºï¼Œä½äºæ¶æ„åˆ†å±‚ä¸­çš„åŸºç¡€è®¾æ–½å±‚ï¼Œæä¾›äº†ç»“æ„æ¸…æ™°ã€å®šä¹‰è§„èŒƒã€å‰ç«¯å¯ç›´æ¥ä½¿ç”¨çš„æ•°æ®ã€‚ä¸ºäº†æ”¶æ•›ä¸šåŠ¡é€»è¾‘ï¼Œæ•°æ®æ¥å£å±‚åªå¯ä»¥è¢«é¢†åŸŸå±‚è°ƒç”¨ã€‚

**apiï¼š**æ•°æ®è¯·æ±‚å±‚ï¼Œè´Ÿè´£Â HTTPÂ è¯·æ±‚ï¼Œæ˜¯é¡¹ç›®ä¸­å”¯ä¸€ä¸åç«¯æœåŠ¡è¿›è¡Œäº¤äº’çš„ä¸€å±‚ã€‚åœ¨è¿™ä¸€å±‚ä¸­é›†ç»“äº†é¡¹ç›®å†…æ‰€æœ‰çš„æ¥å£å‡½æ•°ï¼Œé¿å…äº†æ•°æ®æ¥å£åˆ†æ•£åˆ°å„ä¸ªé¡µé¢ï¼Œç»Ÿä¸€å­˜æ”¾æ›´æ˜“ç®¡ç†ã€‚

**translatorï¼š**æ•°æ®è½¬æ¢å±‚ï¼Œè¿™å±‚è´Ÿè´£å°†åç«¯è¿”å›çš„æ•°æ®ï¼ˆDTOï¼‰â€œæ¸…æ´—â€ï¼Œæ”¹é€ æˆæ›´ç›´è§‚çš„å­—æ®µ(key)ã€æ›´æ–¹ä¾¿ä½¿ç”¨çš„æ•°æ®(value)ã€‚åœ¨è¿™ä¸€å±‚å¯¹æ¥å£å­—æ®µã€å†…å®¹ç»è¿‡äºŒæ¬¡åŠ å·¥ï¼Œé¿å…äº†åç«¯å®šä¹‰å­—æ®µä¸è§„èŒƒã€æ··ä¹±å¯¹å‰ç«¯çš„å½±å“ï¼Œå«ä¹‰æ¸…æ™°ã€è§„èŒƒçš„å­—æ®µåœ¨è§†å›¾å±‚ä½¿ç”¨æ—¶æ›´å…·æœ‰è¡¨ç°åŠ›ï¼Œè¿™é‡Œæˆ‘ä»¬è§£å†³äº†ä¸Šæ–‡æå‡ºçš„æ¥å£å­—æ®µä¸å¯æ§æ€§é—®é¢˜ã€‚åŒç†ï¼Œ**å°†é¢†åŸŸæ•°æ®æäº¤åˆ°åå°ä¹‹å‰ï¼Œéœ€ç»„è£…æˆåå°éœ€è¦çš„DTO**ï¼Œä¹Ÿæ˜¯åœ¨translatorä¸­å®Œæˆã€‚

### è§†å›¾å±‚

åŒ…æ‹¬Â pagesÂ å’ŒÂ componentsÂ ä¸­çš„Â tsxÂ å’Œæ ·å¼éƒ¨åˆ†ã€‚

è§†å›¾å±‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹¦å†™äº¤äº’é€»è¾‘ã€æ ·å¼çš„ä¸€å±‚ï¼Œå”¯ä¸€è·Ÿå‰ç«¯æ¡†æ¶è€¦åˆ(Reactã€Vue)çš„ä¸€å±‚ï¼Œè¿™ä¸€å±‚ä¸€èˆ¬åªéœ€è¦è°ƒç”¨é¡µé¢Â storeï¼Œå°†è¿”å›å€¼ç›´æ¥ä½“ç°åœ¨è§†å›¾å±‚ä¸­ï¼Œæ— éœ€ç¼–å†™æ¡ä»¶åˆ¤æ–­ã€æ•°æ®ç­›é€‰ã€æ•°æ®è½¬æ¢ç­‰ä¸è§†å›¾å±•ç¤ºæ— å…³çš„é€»è¾‘ä»£ç ï¼Œè¿™äº›â€œç³™æ´»â€éƒ½åœ¨å…¶ä»–å±‚ä¸­å·²ç»å®Œæˆï¼Œæ‰€ä»¥è§†å›¾å±‚æ˜¯éå¸¸â€œè–„â€çš„ä¸€å±‚ï¼Œåªéœ€å…³æ³¨è§†å›¾çš„å±•ç¤ºä¸äº¤äº’ï¼Œæ•´ä¸ªÂ HTMLÂ ç»“æ„éå¸¸ç›´è§‚æ¸…æ™°ã€‚

åˆ†å±‚ä½œç”¨ï¼šå°†æ§åˆ¶å±‚ä¸­è¿”å›çš„æ•°æ®ç›´æ¥ä½¿ç”¨ï¼Œè§†å›¾å±‚ä¸­åªç¼–å†™äº¤äº’ä¸æ ·å¼ã€‚é™¤äº†è§†å›¾å±‚ä¸å‰ç«¯æ¡†æ¶æœ‰å…³ï¼Œå…¶ä»–å±‚å¯ç‹¬ç«‹åº”ç”¨äºä»»ä½•æ¡†æ¶çš„ã€‚

### æ§åˆ¶å±‚

åŒ…æ‹¬Â pagesÂ å’ŒÂ componentsÂ ä¸‹çš„Â storeã€‚Â 

ç®¡ç†Â UIÂ çŠ¶æ€ã€å¤„ç†ç”¨æˆ·äº¤äº’ã€å¯¹é¢†åŸŸstoreçš„æ“ä½œæ–¹æ³•å’Œé¢†åŸŸæœåŠ¡è¿›è¡Œç¼–æ’å’Œç»„åˆï¼Œä¸€èˆ¬ä¸åŒ…å«å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚æ§åˆ¶å±‚è¢«è§†å›¾å±‚è°ƒç”¨ã€‚

å¦‚æœé¡µé¢é€»è¾‘å’Œäº¤äº’å¾ˆç®€å•ï¼Œæ§åˆ¶å±‚ä¸æ˜¯å¿…éœ€çš„ï¼Œå¯ä»¥ç”±è§†å›¾å±‚ç›´æ¥è°ƒç”¨é¢†åŸŸå±‚ã€‚

## ç›®å½•ç»“æ„

```powershell
abf-apply-fe  
+ bin                           # å¯æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚æ„å»ºè„šæœ¬
+ config                       # æ„å»ºæ‰“åŒ…é…ç½®
+ src                           # æºä»£ç ç›®å½•
  + domain                  # é¢†åŸŸç›®å½•ï¼Œå¯¹åº”é¢†åŸŸå±‚                      
    + models                  # é¢†åŸŸæ¨¡å‹ (å®ä½“å’Œå€¼å¯¹è±¡)
      + apply                    # ç”³è¯·èšåˆ
        - apply.ts                 # èšåˆæ ¹
        - identity-card.ts           # èº«ä»½ä¿¡æ¯é¡µå®ä½“
        - personal-info.vo.ts        # ä¸ªäººä¿¡æ¯å€¼å¯¹è±¡
      + contract                 # åˆåŒèšåˆ
        - contract.ts 
    + stores                  # é¢†åŸŸstore
      - apply-store.ts           # ç”³è¯·é¢†åŸŸstore
      - contract-store.ts
      - root-store.ts
    + services                # é¢†åŸŸæœåŠ¡
      - form-validation-service.ts  # è¡¨å•æ ¡éªŒæœåŠ¡
  + api                     # æ•°æ®æºç›®å½•ï¼Œå¯¹åº”æ•°æ®æ¥å£å±‚
      + user
        - api.ts                  # ç”¨æˆ·ç›¸å…³APIå°è£…
        - translator.ts           # æ•°æ®è½¬æ¢å™¨
      + ...
  + components               # æ¨¡å—å†…éƒ¨å¯å¤ç”¨ç»„ä»¶
  + pages                     # é¡µé¢ç›®å½•
    + homepage             # page1åŠŸèƒ½ç›®å½•
      + components          # é¡µé¢å†…ç»„ä»¶
        + component1          # é¡µé¢å†…ç»„ä»¶1
          - store.ts         # ç»„ä»¶store
          - index.tsx      
      - index.tsx            # é¡µé¢å…¥å£ï¼Œå¯¹åº”è§†å›¾å±‚
      - store.ts             # é¡µé¢storeï¼Œå¯¹åº”æ§åˆ¶å±‚
    + page2
    + page3
  + constants                # å¸¸é‡é…ç½®    
  + assets                    # å›¾ç‰‡ã€å­—ä½“ç­‰é™æ€èµ„æº
  + styles                      # å…¨å±€æ ·å¼ã€ä¸»é¢˜å˜é‡
  + utils                       # å·¥å…·å‡½æ•°ç›®å½•ï¼Œå¯¹åº”åŸºç¡€å±‚
  - app.tsx                     # æ¨¡å—å…¥å£æ–‡ä»¶ 
  
- .npmrc                        # NPMé…ç½®
- .editorconfig                # ç¼–è¾‘å™¨é…ç½®
- tsconfig.json                # TypeScripté…ç½®
- package.json                 # ä¾èµ–åŒ…å£°æ˜
- package.lock.json           # ä¾èµ–åŒ…ç‰ˆæœ¬é”å®š
- README.md  
```

## DDDÂ çš„å¥½å¤„

å¯¹äºå‰ç«¯è€Œè¨€ï¼Œå®æ–½DDDæœ‰è‚‰çœ¼å¯è§çš„å¥½å¤„ï¼š

*   ç¨³å®šçš„ä¸šåŠ¡çŸ¥è¯†ä½“ç³»
    
*   å¯ä¼ æ‰¿çš„ä»£ç ä½“ç³»
    
*   è„±ç¦»UIçš„å•å…ƒæµ‹è¯•
    
*   è·¨ç«¯å¼€å‘ã€å¤šç«¯å…±ç”¨çš„ä¾¿æ·æ€§
    
*   æ˜ç¡®çš„å›¢é˜Ÿåˆ†å·¥
    
*   éœ€æ±‚å˜æ›´çš„å¿«é€Ÿå“åº”
    
*   æŒç»­æ•æ·
    

è¿™äº›å¥½å¤„å¯¹äºéœ€è¦é•¿æ—¶é—´æŒç»­è¿­ä»£çš„é¡¹ç›®å›¢é˜Ÿè€Œè¨€ï¼Œéå¸¸æœ‰ä»·å€¼ã€‚

## æ­£åé¢æ¡ˆä¾‹

1.  é¢†åŸŸæ¨¡å‹ä¸è¦å®ç°ä¸ºè´«è¡€æ¨¡å‹ã€‚ã€Œè´«è¡€æ¨¡å‹ã€æŒ‡**é¢†åŸŸå¯¹è±¡åªæœ‰æ•°æ®å±æ€§ï¼Œæ²¡æœ‰å°è£…ä¸šåŠ¡è¡Œä¸º**ï¼Œé€»è¾‘é›†ä¸­åœ¨æœåŠ¡æˆ–å…¶ä»–å±‚ï¼›ã€Œå……è¡€æ¨¡å‹ã€æŒ‡**å°†ä¸šåŠ¡è¡Œä¸ºæ–¹æ³•å°è£…åœ¨é¢†åŸŸå¯¹è±¡å†…éƒ¨**ï¼Œå¯¹è±¡æ—¢æœ‰æ•°æ®ä¹Ÿæœ‰è¡Œä¸ºã€‚
    

```typescript
// âœ— é”™è¯¯
// è¿™æ˜¯ä¸€ä¸ªè´«è¡€çš„ Order å®ä½“ï¼Œå®ƒåªçŸ¥é“è‡ªå·±çš„æ•°æ®ï¼Œä¸çŸ¥é“ä»»ä½•ä¸šåŠ¡è¡Œä¸ºã€‚
export class Order {
  public id: string;
  public items: OrderItem[] = [];
  public totalPrice: number = 0;
  public isPaid: boolean = false;

  constructor(id: string) {
    this.id = id;
  }

  // åªæœ‰ä¸€å †å…¬å¼€çš„ getter å’Œ setter (æˆ–ç›´æ¥ public å±æ€§)ï¼Œå…è®¸å¤–éƒ¨è‡ªç”±è¯»å†™
  public setPaid(status: boolean): void {
    this.isPaid = status;
  }

  public setTotalPrice(price: number): void {
    this.totalPrice = price;
  }

  public addItem(item: OrderItem): void {
    this.items.push(item);
  }
}

// âœ“ æ­£ç¡®
// è¿™æ˜¯ä¸€ä¸ªå……è¡€çš„ Order å®ä½“ã€‚æ•°æ®å’Œè¡Œä¸ºè¢«å°è£…åœ¨ä¸€èµ·ã€‚
export class Order {
  public readonly id: string; // ID åˆ›å»ºåä¸å¯å˜
  private _items: OrderItem[] = [];
  private _isPaid: boolean = false;

  constructor(id: string) {
    this.id = id;
  }

  // ---- å…¬å¼€çš„åªè¯»å±æ€§ï¼Œä¿æŠ¤å†…éƒ¨çŠ¶æ€ ----
  public get items(): readonly OrderItem[] {
    return this._items;
  }
  
  public get isPaid(): boolean {
    return this._isPaid;
  }
  
  // æ€»ä»·æ˜¯ä¸€ä¸ªè®¡ç®—å±æ€§ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯éšæ„è®¾ç½®çš„å­—æ®µï¼Œç¡®ä¿å®ƒæ€»æ˜¯æ­£ç¡®çš„
  public get totalPrice(): number {
    return this._items.reduce((sum, item) => sum + item.subtotal, 0);
  }

  // ---- å…¬å¼€çš„ä¸šåŠ¡æ–¹æ³•ï¼Œè¡¨è¾¾ä¸šåŠ¡æ„å›¾ ----
  
  /**
   * å‘è®¢å•ä¸­æ·»åŠ å•†å“ã€‚æ‰€æœ‰ç›¸å…³çš„ä¸šåŠ¡è§„åˆ™éƒ½åœ¨è¿™é‡Œå¼ºåˆ¶æ‰§è¡Œã€‚
   */
  public addItem(productId: string, price: number, quantity: number): void {
    // ä¸šåŠ¡è§„åˆ™ 1: æ£€æŸ¥è®¢å•æ˜¯å¦å·²æ”¯ä»˜ (ä¿æŠ¤ä¸å˜é‡)
    if (this._isPaid) {
      throw new Error("Cannot add items to a paid order.");
    }
    
    // ä¸šåŠ¡è§„åˆ™ 2 & 3: åˆ›å»ºå¹¶æ·»åŠ å•†å“ã€‚æ€»ä»·ä¼šè‡ªåŠ¨é€šè¿‡ getter è®¡ç®—ï¼Œæ— éœ€æ‰‹åŠ¨æ›´æ–°ã€‚
    const newItem = new OrderItem(productId, price, quantity);
    this._items.push(newItem);
    
    console.log(`Item added. New total price for order ${this.id} is ${this.totalPrice}`);
  }

  /**
   * æ”¯ä»˜è®¢å•
   */
  public pay(): void {
    if (this._items.length === 0) {
      throw new Error("Cannot pay for an empty order.");
    }
    this._isPaid = true;
    console.log(`Order ${this.id} has been paid.`);
  }
}
```

2.  ä¸è¦æŠŠåå°æ¥å£æ•°æ®å–å›åï¼Œç›´æ¥ä¸€è‚¡è„‘ä¸¢ç»™storeç”¨ä¸€ä¸ªå¤§å¯¹è±¡è¿›è¡Œå‚¨å­˜ã€‚è¦æŒ‰å®é™…çš„ä¸šåŠ¡é€»è¾‘æ¥è®¾è®¡çš„é¢†åŸŸæ¨¡å‹çš„ç»“æ„ï¼Œåªå–æ‰€éœ€çš„å­—æ®µï¼Œå¹¶é€šè¿‡Â translatorÂ æ¥è½¬æ¢é¢†åŸŸæ•°æ®å’Œåå°æ•°æ®ã€‚
    
3.  é¢†åŸŸæ¨¡å‹ä¸å¤Ÿçº¯ç²¹ï¼Œæ—¢æœ‰å•ä¸ªå®ä½“çš„æ•°æ®ï¼Œåˆæœ‰å¤šä¸ªå®ä½“é›†åˆçš„æ•°æ®ã€‚
    

```typescript
// âœ— é”™è¯¯
class ContractModel implements ContractInfo {
  /**
   * å¼ºè¯»æ ‡è¯†ï¼Œå•ä¸ªåˆåŒçš„å±æ€§
   */
  @observable forceReadFlag = '';

  /**
   * åˆåŒä¿¡æ¯åˆ—è¡¨ï¼ŒåˆåŒé›†åˆæ•°æ®
   */
  @observable contractInfoList = null;

  /**
   * åˆåŒå±•ç¤ºæ–‡æ¡ˆï¼ŒUI å±‚æ‰€éœ€
   */
  @observable displayText = '';
}

// âœ“ æ­£ç¡®
// åˆåŒæ¨¡å‹åˆ†ä¸ºå•ä½“åˆåŒæ¨¡å‹ contract ä»¥åŠåˆåŒåˆé›† contractCollection
export class Contract {
  /** åˆåŒå”¯ä¸€æ ‡è¯† */
  id: number;

  /** å¼ºè¯»æ ‡è¯† Y/N */
  forceReadFlag: string;

  /**
   * ä¸šåŠ¡é€»è¾‘ï¼šæ£€æŸ¥æ˜¯å¦éœ€è¦å¼ºåˆ¶é˜…è¯»
   */
  isForceRead(): boolean {
    return this.forceReadFlag === 'Y';
  }
}

export class ContractCollection {
  /** åˆåŒåˆ—è¡¨ */
  public contracts: Contract[];

  /**
   * ä¸šåŠ¡é€»è¾‘ï¼šè·å–åˆåŒå±•ç¤ºæ–‡æ¡ˆ
   */
  getDisplayText(): string {
    if (this.contracts && this.contracts.length > 0) {
      const contractTextArr: string[] = [];
      this.contracts.forEach((contract: Contract) => {
        // è¿‡æ»¤å‡ºè´·æ¬¾å‘ŠçŸ¥ä¹¦
        if (contract.contractType !== 'LOAN_APPLY_NOTICE') {
          contractTextArr.push(contract.getDisplayText());
        }
      });
      return contractTextArr.join('ã€');
    } else {
      ...
    }
  }

  /**
   * ä¸šåŠ¡é€»è¾‘ï¼šè·å–å¼ºè¯»åˆåŒåˆ—è¡¨
   */
  getForceReadContracts(): Contract[] {
    return this.contracts.filter(contract => contract.isForceRead());
  }
}
```

4.  åå°æ¥å£æ•°æ®Â å’ŒÂ é¢†åŸŸå¯¹è±¡æ•°æ®çš„è½¬æ¢ï¼Œæ²¡æœ‰æ”¾åœ¨Â translatorÂ ä¸­å¤„ç†ã€‚
    

```typescript
// âœ— é”™è¯¯
// src/domain/models/apply/personal-info.vo.ts
export class PersonalInfoModel implements PersonalInfo {
    ...
   /**
    * ç»„è£…æäº¤å‚æ•°
    * æ”¶é›†è¡¨å•æ•°æ®å¹¶ç»„è£…æˆæäº¤æ ¼å¼
    * @returns æäº¤å‚æ•°å¯¹è±¡
    */
   @action.bound
   assembleSubmitParams(): any {
    const {
      custName,
      certId,
      custTypeSelected,
      careerType,
      incomeRange,
      highestDegree,
      schoolName,
      graduateYear
    } = this;
    
    // ç»„è£…æäº¤å‚æ•°
    const submitParams = {
      applyPersonalInfo: {
        custName,
        certId,
        custTypeSelected
      },
      applyCompanyInfo: {
        careerType,
        incomeRange,
      },
      applyEducationInfo: {
        highestDegree,
        schoolName,
        graduateYear,
      },
    };
    
    console.log('ğŸ“‹ [FormValidationService] ç»„è£…æäº¤å‚æ•°:', submitParams);
    return submitParams;
  }
}


// âœ“ æ­£ç¡®
// src/api/apply/translator.ts
export function personalInfoSubmitTranslator(personalInfo: {
  custName?: string;
  certId?: string;
  custTypeSelected?: string;
  careerType?: string;
  incomeRange?: string;
  highestDegree?: string;
  schoolName?: string;
  graduateYear?: string;
}): any {
  const {
    custName = '',
    certId = '',
    custTypeSelected = '',
    careerType = '',
    incomeRange = '',
    highestDegree = '',
    schoolName = '',
    graduateYear = '',
  } = personalInfo || {};

  // ç»„è£…æäº¤å‚æ•° - æŒ‰ç…§åç«¯æ¥å£è¦æ±‚çš„ DTO ç»“æ„
  const submitParams = {
    // ä¸ªäººåŸºç¡€ä¿¡æ¯
    applyPersonalInfo: {
      custName,
      certId,
      custTypeSelected,
    },
    // èŒä¸šæ”¶å…¥ä¿¡æ¯
    applyCompanyInfo: {
      careerType,
      incomeRange,
    },
    // æ•™è‚²èƒŒæ™¯ä¿¡æ¯
    applyEducationInfo: {
      highestDegree,
      schoolName,
      graduateYear,
    },
  };

  return submitParams;
}
```

5.  é¿å…åœ¨è§†å›¾å±‚ç›´æ¥è°ƒç”¨Â APIï¼Œåœ¨è§†å›¾å±‚è¿›è¡Œæ•°æ®è½¬æ¢ç­‰
    

```typescript
// âœ— é”™è¯¯
class HomePage extends Component {
  async componentDidMount() {
    // ä¸åº”è¯¥åœ¨è§†å›¾å±‚ç›´æ¥è°ƒç”¨ API
    const data = await fetch('/api/user');
    // ä¸åº”è¯¥åœ¨è§†å›¾å±‚è¿›è¡Œæ•°æ®è½¬æ¢
    this.setState({ 
      userName: data.nickName || 'æœªçŸ¥ç”¨æˆ·' 
    });
  }
}

// âœ“ æ­£ç¡®
// model å±‚
@action.bound
updateUser = (userInfo: Partial<UserInfo>) => {
  this.user.setState(userInfo);
};

// æ•°æ®æ¥å£å±‚ï¼Œçº¯å‡½æ•°è½¬æ¢å™¨
export function userInfoTranslator(data: any): UserInfo {
  return {
    name: data.nickName || '',
    // ...
  };
}
```

### FAQ

## å‚è€ƒèµ„æ–™

*   [é¢†åŸŸé©±åŠ¨è®¾è®¡åœ¨å‰ç«¯ä¸­çš„åº”ç”¨](https://mp.weixin.qq.com/s/pROCXZNZ7RKeYDlDUJng_Q)
    
*   [æ¢ç©¶Â DDDÂ åœ¨å‰ç«¯å¼€å‘ä¸­çš„åº”ç”¨ï¼ˆäºŒï¼‰ï¼šä»€ä¹ˆæ˜¯Â DDD](https://darkyzhou.net/articles/frontend-with-ddd-2)
    
*   [ã€Šé¢†åŸŸé©±åŠ¨è®¾è®¡ç²¾ç²¹ã€‹ï¼ˆä½œè€…Â VaughnÂ Vernonï¼‰](https://alidocs.dingtalk.com/i/nodes/vy20BglGWOaOMNRvil92Mpj7JA7depqY)